## 1、事件简介

```
redis 服务器是一个事件驱动程序，服务器需要处理以下两类事件：

文件事件(file event):redis 服务器通过套接字与客户端(或者其他 redis 服务器)进行链接，而文件事件就是服务器对套接字操作的抽象。服务器与客户端(或者其他服务器)的通信会产生相应的文件事件，而服务器则通过监听并处理这些事件来完成一系列网络通信操作。

时间事件(time event):redis 服务器中的一些操作(比如 serverCron函数) 需要在给定的时间点执行，而时间事件就是服务器对这类定时操作的抽象。
```

## 2、文件事件

```
redis 基于 reactor 模式开发了自己的网络事件处理器：这个处理器被称为文件事件处理器(file event handler):
	文件事件处理器使用I/O多路复用(multiplexing) 程序来同时监听多个套接字，并根据套接字目前执行的任务来为套接字关联不同的事件处理器。
	
	当被监听的套接字准备好执行连接应答(accept)、读取(read)、写入(write)、关闭(close)等操作时，与操作相对应的文件事件就会产生，这时文件事件处理器来处理这些事件。
	虽然文件事件处理器以单线程方式运行，但通过使用I/O多路复用程序来监听多个套接字，文件事件处理器既实现了高性能的网络通信模型，又可以很好地与 redis 服务器中其他同样以单线程方式运行的模块进行对接，这保持了 redis 内部单线程设计的简单性。
```

### 1、文件事件处理器的构成

```
下图展示了文件事件处理器的四个组成部分，它们分别是套接字、I/O多路复用程序、文件事件分派器(dispatcher),以及事件处理器。
```

![](images12/01-01.jpg)

```
文件事件是对套接字操作的抽象，每当一个套接字准备好执行连接应答(accept)、写入、读取、关闭等操作时，就会产生一个文件事件。因为一个服务器通常会链接多个套接字，所以多个文件事件可能会并发的出现。

I/O多路复用程序负责监听多个套接字，并向文件事件分派器传送那些产生了事件的套接字。

尽管多个文件事件可能会并发地出现，但I/O多路复用程序总是会将所有产生事件的套接字都放到一个队列里面，然后通过这个队列，以有序(sequentially)、同步(synchronously)、
```

