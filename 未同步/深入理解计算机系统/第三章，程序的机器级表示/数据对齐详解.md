## 1、什么是数据对齐

```
1、现代计算机内存空间都是按照 byte 划分的，从理论上讲似乎对任何类型的变量的访问可以从任何地址开始，但实际情况是在访问特定变量的时候经常在特定的内存地址访问。

这就需要各类型数据按照一定的规则在空间上排列，而不是顺序的一个接一个的排放，这就是对齐。
```

```
2、访问数据的地址要满足一定的条件，能被这个数据的长度所整除。

例如 short 的访问数据的地址必须能被 2 整除.
```

```
3、数据对齐并不是操作系统的内存结构的一部分，而是CPU结构的一部分。
```

```
4、当CPU 访问正确对齐的数据时，它的运行效率最高。当数据大小的数据模数的内存地址是 0 时，数据时对齐的。

当C P U试图读取的数据值没有正确对齐时， C P U可以执行两种操作之一。即它可以产生一个异常条件，也可以执行多次对齐的内存访问，以便读取完整的未对齐数据值。
```



## 2、对齐的原因

```
1、 现在各个硬件平台对存储空间的处理上有很大的不同。一些平台对某些特定类型的数据只能从某些特定地址开始存取。其他平台可能没有这种情况， 但是最常见的是如果不按照适合其平台的要求对数据存放进行对齐，会在存取效率上带来损失。比如有些平台每次读都是从偶地址开始，如果一个int型（假设为 32位）如果存放在偶地址开始的地方，那么一个读周期就可以读出，而如果存放在奇地址开始的地方，就可能会需要2个读周期，并对两次读出的结果的高低 字节进行拼凑才能得到该int数据。显然在读取效率上下降很多。这也是空间和时间的博弈。

2、数据对齐是为了读取数据的效率。假如说每一次 读取数据时都是一个字节一个字节读取，那就不需要对齐了，这跟读一个字节没有什 么区别，就是多读几次。但是这样读取数据效率不高。为了提高读取数据的带宽，现 代存储系统都采用许多并行的存储芯片来提高读取效率。
```



## 3、数据对齐的实现

```
各成员变量存放的地址相对于结构的起始地址的偏移量为 sizeof(类型)或其整数倍。

结构的总大小是其成员中最大类型的 sizeof(该类型)整数倍。

所以在定义结构体时最好把结构中的变量按照类型大小从小到大声明，以减少中间的填补空间。
```









